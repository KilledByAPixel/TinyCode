<!--

"Queen's Gambit" - AKA Chesstron 1024
Created by Frank Force 2019
License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.

Arrow keys move. Mouse aims. There are 9 levels. God save the ♛!

♟, ♜, ♝, and ♞ have rebelled killed the ♚!
It's up to you to... throw ♥ at them.
Kill them with kindness, that's what I always say. 

-->

<html>
<head><title>Queen's Gambit</title></head>
<meta charset="utf-8">
<body style="background-color:#000;margin:0">
<canvas id=a style='touch-action:none'></canvas>
<script>

// init shim variables 
d=document;b=d.body;c=a.getContext`2d`;
a.width = innerWidth;
a.height = innerHeight;
onresize = e => location.reload();

// 1023 bytes
for(_=`=>F=nFEkeyDa-oZe-sY],Xr[W9,V?-U0>)+onc.fillText())n.0,push(new C(?0:),)+=Style="w(a.heighta.width/2,/2,map(nF&&	this)**2<(f+c)**2	(==p	(s,o,U.5:!p|3==p?.8:1,EWDCode%37]=2)U4:4splice(indexOf(C=functi(t,l,f,p){.b=(iF{e1<p,c.ft=2*f+"px'",hsl("+80*(p-2?4+p:h/9" 90%"+(-1<p?50:99"%)",p-2?"❀♛♥♛♞1♟♜♝"[m>93+p]:" "+m,s-f,o+f/2st*=s+t>|s+tol*=o+l>|o+lp|1f*=13<fU1>p?.9:.99:1p||("♛x"+I,V49tW2]-W0XlW3]-W1X0==h%5	(u-s)/V(v-o)/V18,-1)a(f,p,}.a=((e,a,c,d,u)F{0<p&-3<d&1>d&(!!d|9<h)	(!d&60<h&!x)	(3tYU9:VlZU9:9440<++f	f=25,3l=(t=2))59)||(Y)/8(Z)/851t=,l=(YZ2*f,-3d+2	u11dy=--I})},setInterval(tF{if(#0005",Rect(,e=b(0==++h%50	9<x	--x,!e||y	0<I)for(i=e||25*++m,x=40-m,y=h=n=[X9>=m	25,/V-2;i--;)25+92!3!32},16Ddown2,DupmousemoveE{u=x,v=y},r=[m=h=u=v=y=n=[X0XI=3,wEMath.random()*n|0`;G=/[-U-ZD-F]/.exec(_);)with(_.split(G))_=join(shift());eval(_)

// uncrushed
//A=function(t,l,s,o,f,p){this.b=(i=>{e+=1<p,c.font=2*f+"px'",c.fillStyle="hsl("+80*(p-2?4+p:h/9)+" 90%"+(-1<p?50:99)+"%)",c.fillText(p-2?"❀♛♥♛♞1♟♜♝"[m>9?0:3+p]:" "+m,s-f,o+f/2),s+=t*=s+t>a.width|0>s+t?-.5:!p|3==p?.8:1,o+=l*=o+l>a.height|0>o+l?-.5:!p|3==p?.8:1,0>p|1==p&&(f*=13<f?-1>p?.9:.99:n.splice(n.indexOf(this),1)),p||(c.fillText("♛x"+z,9,49),t+=r[2]-r[0],l+=r[3]-r[1],0==h%5&&n.push(new A((u-s)/9,(v-o)/9,s,o,18,-1))),n.map(n=>n.a(s,o,f,p,this))}),this.a=((e,a,c,d,u)=>{0<p&-3<d&1>d&(!!d|9<h)&&(!d&60<h&!w(x)&&(3==p&&(t+=0>e-s?-9:9,l+=0>a-o?-9:9),4==p&&(40<++f&&n.push(new A(0,0,s,o,f=25,3)),l=(t=w(2)?0:w(2)?-4:4)?0:w(2)?-4:4),5==p&&(w(9)||n.push(new A((e-s)/80,(a-o)/80,s,o,50,1)),t=w(2)?-4:4,l=w(2)?-4:4)),(e-s)**2<(f+c)**2&&(a-o)**2<(f+c)**2&&(n.push(new A(0,0,s,o,2*f,-3)),d+2&&n.splice(n.indexOf(u),1),n.splice(n.indexOf(this),1),d?0:y=--z))})},setInterval(t=>{if(c.fillStyle="#0005",c.fillRect(0,0,a.width,a.height),e=0,n.map(n=>n.b()),0==++h%50&&9<x&&--x,!e||y&&0<z)for(i=e||25*++m,x=40-m,y=h=0,n=[],9>=m&&n.push(new A(0,0,a.width/2,a.height/2,25,0,n.push(new A(0,0,a.width/2,a.height/2,a.width/9,-2))));i--;)n.push(new A(0,0,w(a.width),w(a.height),25+w(9),w(2)+!w(3)+!w(3)+2))},16),onkeydown=n=>r[n.keyCode%37]=2,onkeyup=n=>r[n.keyCode%37]=0,onmousemove=n=>{u=n.x,v=n.y},r=[m=h=u=v=y=n=[],0,0,0],z=3,w=n=>Math.random()*n|0

// ENHANCE - wasd control
WASD=x=>x==87?1:x==83?3:x==65?0:x==68?2:4
onkeydown   =x=>{r[WASD(x.keyCode)]=2;r[x.keyCode%37]=2;}
onkeyup     =x=>{r[WASD(x.keyCode)]=0;r[x.keyCode%37]=0;}

</script>
</body>
</html>